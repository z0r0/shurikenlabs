{"version":3,"sources":["infinitescroll.js"],"names":["$","currentPage","pathname","window","location","$document","document","$result","buffer","ticking","isLoading","lastScrollY","scrollY","lastWindowHeight","innerHeight","lastDocumentHeight","height","onScroll","requestTick","onResize","requestAnimationFrame","infiniteScroll","maxPages","nextPage","get","content","append","find","hide","fadeIn","fail","xhr","status","removeEventListener","passive","always","replace","addEventListener"],"mappings":"AACAA,EAAE,SAAUA,GACR,IAAIC,EAAc,EACdC,EAAWC,OAAOC,SAASF,SAC3BG,EAAYL,EAAEM,UACdC,EAAUP,EAAE,cACZQ,EAAS,IAETC,GAAU,EACVC,GAAY,EAEZC,EAAcR,OAAOS,QACrBC,EAAmBV,OAAOW,YAC1BC,EAAqBV,EAAUW,SAKnC,SAASC,IACLN,EAAcR,OAAOS,QACrBM,IAGJ,SAASC,IACLN,EAAmBV,OAAOW,YAC1BC,EAAqBV,EAAUW,SAC/BE,IAGJ,SAASA,IACAT,GACDW,sBAAsBC,GAE1BZ,GAAU,EAGd,SAASY,IAEL,IAAIX,EAKJ,GAAIC,EAAcE,GAAoBE,EAAqBP,EACvDC,GAAU,OAKd,GAAIR,IAAgBqB,SAApB,CAIAZ,GAAY,EAMZ,IAAIa,EAAWrB,EAAW,UAH1BD,EAGiD,IAEjDD,EAAEwB,IAAID,EAAU,SAAUE,GACtBlB,EAAQmB,OAAO1B,EAAEyB,GAASE,KAAK,SAASC,OAAOC,OAAO,QAEvDC,KAAK,SAAUC,GAEK,MAAfA,EAAIC,SACJ7B,OAAO8B,oBAAoB,SAAUhB,EAAU,CAACiB,SAAS,IACzD/B,OAAO8B,oBAAoB,SAAUd,MAG1CgB,OAAO,WACNpB,EAAqBV,EAAUW,SAE/BP,EADAC,GAAY,KAzDpBR,EAAWA,EAASkC,QAAQ,UAAW,IAAIA,QAAQ,OAAS,KA8D5DjC,OAAOkC,iBAAiB,SAAUpB,EAAU,CAACiB,SAAS,IACtD/B,OAAOkC,iBAAiB,SAAUlB,GAElCE","file":"infinitescroll.js","sourcesContent":["// Code snippet inspired by https://github.com/douglasrodrigues5/ghost-blog-infinite-scroll\n$(function ($) {\n    var currentPage = 1;\n    var pathname = window.location.pathname;\n    var $document = $(document);\n    var $result = $('.post-feed');\n    var buffer = 100;\n\n    var ticking = false;\n    var isLoading = false;\n\n    var lastScrollY = window.scrollY;\n    var lastWindowHeight = window.innerHeight;\n    var lastDocumentHeight = $document.height();\n\n    // remove hash params from pathname\n    pathname = pathname.replace(/#(.*)$/g, '').replace('/\\//g', '/');\n\n    function onScroll() {\n        lastScrollY = window.scrollY;\n        requestTick();\n    }\n\n    function onResize() {\n        lastWindowHeight = window.innerHeight;\n        lastDocumentHeight = $document.height();\n        requestTick();\n    }\n\n    function requestTick() {\n        if (!ticking) {\n            requestAnimationFrame(infiniteScroll)\n        }\n        ticking = true;\n    }\n\n    function infiniteScroll () {\n        // return if already loading\n        if (isLoading) {\n            return;\n        }\n\n        // return if not scroll to the bottom\n        if (lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\n            ticking = false;\n            return;\n        }\n\n        // return if currentPage is the last page already\n        if (currentPage === maxPages) {\n            return;\n        }\n\n        isLoading = true;\n\n        // next page\n        currentPage++;\n\n        // Load more\n        var nextPage = pathname + 'page' + currentPage + '/';\n\n        $.get(nextPage, function (content) {\n            $result.append($(content).find('.post').hide().fadeIn(100));\n\n        }).fail(function (xhr) {\n            // 404 indicates we've run out of pages\n            if (xhr.status === 404) {\n                window.removeEventListener('scroll', onScroll, {passive: true});\n                window.removeEventListener('resize', onResize);\n            }\n\n        }).always(function () {\n            lastDocumentHeight = $document.height();\n            isLoading = false;\n            ticking = false;\n        });\n    }\n\n    window.addEventListener('scroll', onScroll, {passive: true});\n    window.addEventListener('resize', onResize);\n\n    infiniteScroll();\n});\n"]}